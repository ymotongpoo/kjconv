# kjconv: 敬体常体変換

本プロジェクトは日本語の文章の文体を統一するためのライブラリおよびツールです。
本プロジェクトの主な機能は以下のとおりです。

## 基本仕様

### 1. 基本要件

* 入力
  * 変換対象の日本語テキスト（文字列）
  * 変換モードの指定（「常体から敬体へ」または「敬体から常体へ」）
* 出力
  * 変換後の日本語テキスト（文字列）
* 処理単位
  * テキストを句点（。）、疑問符（？）、感嘆符（！）で文に分割し、各文に対して変換処理を適用する

### 2. 形態素解析の要件

* 入力された文を形態素解析し、各形態素について以下の情報を取得できること。
  * 表層形（実際に現れる文字列）
  * 品詞
  * 品詞細分類1, 2, 3
  * 活用型（例：五段・マ行、下一段など）
  * 活用形（例：終止形、連用形、未然形など）
  * 原形（基本形）

### 3. 変換ルール：常体 → 敬体

* 基本方針: 文末の形態素、およびそれに連なる助動詞などを主な変換対象とする
* 動詞の変換
  * 条件: 文末の形態素が動詞の「終止形」または「連体形」
  * 処理:
    1. 該動詞の「連用形」を取得または生成する。
    2. 連用形 + 「ます」に置換する。（例: `読む` → `読みます`）
* 形容詞（イ形容詞）の変換
  * 条件: 文末の形態oseiが形容詞の「終止形」または「連体形」
  * 処理: 当該形態素の表層形 + 「です」に置換する（例: `美しい` → `美しいです`）
* 名詞・形容動詞の変換:
  * 条件: 文末が断定の助動詞「だ」「である」。
  * 処理:
    * `だ` → `です` に置換（例: `静かだ` → `静かです`）
    * `である` → `です` または `であります` に置換（例: `学者である` → `学者です`）
* 各種助動詞・文末表現の変換:
  * 文末の形態素が以下の常体表現の場合、対応する敬体表現に置換する辞書（対応表）を用いて変換する
    * `～た` (過去) → 直前の動詞/形容詞を連用形にし、`～ました`/`～かったです` に変換
    * `～ない` (否定) → 直前の動詞を未然形にし、`～ません` に変換。形容詞の場合は `～くありません` または `～くないです` に変換
    * `～だろう` → `～でしょう`
    * `～ようだ` → `～ようです`
    * `～かもしれない` → `～かもしれません`
    * `～のだ` / `～んだ` → `～のです` / `～んです`
    * `～わけだ` → `～わけです`
    * `～はずだ` → `～はずです`

### 4. 変換ルール：敬体 → 常体

* 基本方針: 文末の丁寧語表現（ます、です、等）を検出し、対応する常体表現に変換する。
* 動詞の変換 (`～ます`系)
  * 条件: 文末が丁寧の助動詞「ます」およびその活用形（`ました`, `ません`, `ませんでした`, `ましょう`）
  * 処理
    1. 「ます」等を除去し、直前の動詞（連用形）の原形を取得する。
    2. `ます` → 終止形 (`読みます` → `読む`)
    3. `ました` → 過去形（タ形） (`読みました` → `読んだ`)
    4. `ません` → 否定形（ナイ形） (`読みません` → `読まない`)
    5. `ましょう` → 終止形（勧誘の意図は失われるが、文体変換を優先） (`読みましょう` → `読む`)
* 形容詞・名詞・形容動詞の変換 (`～です`系)
  * 条件: 文末が「です」「でした」「ではありません」「でしょう」等。
  * 処理: 対応する常体表現に置換する。
    * `～です` → `～だ`（直前が名詞・形容動詞）、または「です」を削除（直前が形容詞）。（`学生です` → `学生だ` / `美しいです` → `美しい`）
    * `～でした` → `～だった`
    * `～ではありません` → `～ではない`
    * `～でしょう` → `～だろう`
    * `～くありません` → `～くない`
* 複合表現の変換
  * `～かもしれません` → `～かもしれない`
  * `～のです` / `～んです` → `～のだ` / `～んだ`

### 5. 接続詞・副詞の変換（オプション）

* 文全体の丁寧さを調整するため、文頭の特定の接続詞を変換する。
* **常体→敬体**: `だから` → `ですから`, `だが` → `ですが`
* **敬体→常体**: `ですから` → `だから`, `ですが` → `だが`

### 6. 例外処理とハンドリング

* 変換対象外
  * 鉤括弧「」『』内の引用文は変換処理を行わない。
  * 体言止め（文末が名詞）の文は、原則として変換しない。
  * 倒置法など、ルールベースでの判定が困難な構文は変換をスキップするか、警告を出す。
* エラーハンドリング
  * 形態素解析に失敗した場合、エラーメッセージを返して処理を中断する。
  * 定義された変換ルールに合致しない文末表現の場合、変換を行わず原文を維持する。

## 技術仕様

* Go言語で実装する
* 形態素解析には [kagome v2](https://pkg.go.dev/github.com/ikawaha/kagome/v2) を利用する
  * 辞書は [IPADIC](https://pkg.go.dev/github.com/ikawaha/kagome-dict/ipa) を利用する
  * IPADICを利用した場合の解析結果のサンプルと辞書素性の内容は [このページ](https://zenn.dev/ikawaha/books/kagome-v2-japanese-tokenizer/viewer/dictionary) を参考にすること
  * とくに形態素解析のサンプルコードは [こちら](https://github.com/ikawaha/kagome/blob/v2/_examples/tokenize/main.go) を参考にすること

### プロジェクト構成

* ルートディレクトリ: パッケージ github.com/ymotongpoo/kjconv をライブラリとして実装するパッケージ
* cmd: パッケージ github.com/ymotongpoo/kjconv をインポートし、grhコマンドを実装するためのパッケージ
